@model Performance_Appraisal_System.Models.Report38

@{
    ViewBag.Title = "विनिर्दिष्ट अहवालावर निबंधकाने केलेली कारवाई";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

@{
    Html.RenderPartial("PrevNextBar");
}


@using (Html.BeginForm("Subject38", "UpdateReports", FormMethod.Post))
{

    <div class="container" style="padding: 30px;background: white;">
        <div class="col-md-12" style="box-shadow: 0px 0px 5px lightgrey;">
            <br>
            <br>
            <h3 class="card-title text-center"><strong>विभागीय सहनिबंधक, जिल्हा उपनिबंधक व त्या अंतर्गत असलेले उपनिबंधक कार्यालये यांसाठी अधिकाऱ्यांचा मूल्यांक भारांक तक्ता</strong></h3>
            <hr>
            <div class="card-text">
                <div class="center-group">
                    <div class="form-row">
                        <div class="form-group col-md-12 center-div" style="color: #e77817 !important; font-size: 20px;">
                            कार्यासनाचे नाव: <strong> @Session["ReportDepartmentName"].ToString() </strong> &nbsp&nbsp&nbsp|&nbsp&nbsp&nbsp विषय: <strong> @ViewBag.Title </strong>
                            &nbsp&nbsp&nbsp|&nbsp&nbsp&nbsp<strong> गुण:  @Session["TotalMarks"].ToString() </strong>
                        </div>
                    </div>

                    <div class="form-row">
                        <div class="form-group col-md-6">
                            @Html.DropDownListFor(model => model.Month, (IEnumerable<SelectListItem>)ViewBag.Months, "-- महिना निवडा --", new { @class = "form-control" })
                            <br>
                            @Html.ValidationMessageFor(temp => temp.Month)
                        </div>

                        <div class="form-group col-md-6">
                            @Html.DropDownListFor(model => model.Year, (IEnumerable<SelectListItem>)ViewBag.Years, "-- वर्ष निवडा --", new { @class = "form-control" })
                            <br>
                            @Html.ValidationMessageFor(temp => temp.Year)
                        </div>
                    </div>

                </div>
            </div>
        </div>
    </div>

    <div class="form-group col-md-12 center-div" style="font-size: 20px;">
        @Html.CheckBoxFor(temp => temp.NotApplicable, new { id = "NotApplicable" })
        <strong>&nbsp&nbspविषय लागु नाही / या महिन्यासाठी उद्दिष्ट व साध्य लागु नाही</strong>
    </div>

    <div id="WrappperDiv">
        <div class="container" style="padding: 30px;background: white;">
            <div class="col-md-12" style="box-shadow: 0px 0px 5px lightgrey;">
                <div class="card-text">
                    <div class="center-group">
                        <br>
                        <span style="color: #e77817 !important; font-size: 16px;">विनिर्दिष्ट अहवालांची माहिती</span>
                        <hr>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Last_Year_Pending)
                                @Html.TextBoxFor(temp => temp.Last_Year_Pending, new { id = "Last_Year_Pending", @class = "form-control" })
                                @Html.ValidationMessageFor(temp => temp.Last_Year_Pending)
                            </div>


                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Last_Month_Reports)
                                @Html.TextBoxFor(temp => temp.Last_Month_Reports, new { id = "Last_Month_Reports", @class = "form-control" })
                                @Html.ValidationMessageFor(temp => temp.Last_Month_Reports)
                            </div>

                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Current_Month_Reports)
                                @Html.TextBoxFor(temp => temp.Current_Month_Reports, new { id = "Current_Month_Reports", @class = "form-control" })
                                @Html.ValidationMessageFor(temp => temp.Current_Month_Reports)
                            </div>


                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Total_Reports)
                                @Html.TextBoxFor(temp => temp.Total_Reports, new { id = "Total_Reports_val", @class = "form-control", disabled = "disabled" })
                                @Html.ValidationMessageFor(temp => temp.Total_Reports)
                                @Html.HiddenFor(temp => temp.Total_Reports, new { id = "Total_Reports" })
                            </div>

                        </div>

                    </div>
                </div>
            </div>
        </div>

        <div class="container" style="padding: 30px;background: white;">
            <div class="col-md-12" style="box-shadow: 0px 0px 5px lightgrey;">
                <div class="card-text">
                    <div class="center-group">
                        <br>
                        <span style="color: #e77817 !important; font-size: 16px;"> कारवाईची माहिती</span>
                        <hr>

                        <div class="form-row">
                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Last_Month_Action_Taken)
                                @Html.TextBoxFor(temp => temp.Last_Month_Action_Taken, new { id = "Last_Month_Action_Taken", @class = "form-control" })
                                @Html.ValidationMessageFor(temp => temp.Last_Month_Action_Taken)
                            </div>

                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Current_Month_Action_Taken)
                                @Html.TextBoxFor(temp => temp.Current_Month_Action_Taken, new { id = "Current_Month_Action_Taken", @class = "form-control" })
                                @Html.ValidationMessageFor(temp => temp.Current_Month_Action_Taken)
                            </div>


                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Total_Action_Taken)
                                @Html.TextBoxFor(temp => temp.Total_Action_Taken, new { id = "Total_Action_Taken_val", @class = "form-control", disabled = "disabled" })
                                @Html.ValidationMessageFor(temp => temp.Total_Action_Taken)
                                @Html.HiddenFor(temp => temp.Total_Action_Taken, new { id = "Total_Action_Taken" })
                            </div>

                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Action_Pending_Reports)
                                @Html.TextBoxFor(temp => temp.Action_Pending_Reports, new { id = "Action_Pending_Reports_val", @class = "form-control", disabled = "disabled" })
                                @Html.ValidationMessageFor(temp => temp.Action_Pending_Reports)
                                @Html.HiddenFor(temp => temp.Action_Pending_Reports, new { id = "Action_Pending_Reports" })
                            </div>

                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="container" style="padding: 30px;background: white;">
            <div class="col-md-12" style="box-shadow: 0px 0px 5px lightgrey;">
                <div class="card-text">
                    <div class="center-group">
                        <br>
                        <span style="color: #e77817 !important; font-size: 16px;">मुल्यांकनानुसार प्राप्त गुण</span>
                        <hr>
                        <div class="form-row">
                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Percentage_Action_Taken)
                                @Html.TextBoxFor(temp => temp.Percentage_Action_Taken, new { id = "Percentage_Action_Taken_val", @class = "form-control", disabled = "disabled" })
                                @Html.ValidationMessageFor(temp => temp.Percentage_Action_Taken)
                                @Html.HiddenFor(temp => temp.Percentage_Action_Taken, new { id = "Percentage_Action_Taken" })

                            </div>

                            <div class="form-group col-md-6">
                                @Html.LabelFor(temp => temp.Appraisal_Marks)
                                @Html.TextBoxFor(temp => temp.Appraisal_Marks, new { id = "Appraisal_Marks_val", @class = "form-control", disabled = "disabled" })
                                @Html.ValidationMessageFor(temp => temp.Appraisal_Marks)
                                @Html.HiddenFor(temp => temp.Appraisal_Marks, new { id = "Appraisal_Marks" })
                            </div>


                            @*<div class="form-group col-md-10">
                                    @Html.LabelFor(temp => temp.Remarks)
                                    @Html.TextAreaFor(temp => temp.Remarks, new { id = "Remarks", @class = "form-control" })
                                    @Html.ValidationMessageFor(temp => temp.Remarks)
                                </div>*@

                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>


    <div class="container" style="padding: 30px;background: white;">
        <div class="col-md-12" style="box-shadow: 0px 0px 5px lightgrey;">
            <div class="card-text">
                <div class="center-group">
                    <br>
                    <span style="color: #e77817 !important; font-size: 17px;">
                        Confirmation / पुष्टीकरण
                    </span>
                    <hr>

                    <div style="text-align:justify; font-size: 16px; line-height:25px">
                        I affirm that the above mentioned information submitted by me is true and correct to my knowledge and belief. / मी प्रमाणित करतो की मी वर नमूद केलेली माहिती माझ्या माहितीनुसार सत्य आणि अचूक आहे.
                    </div>
                    <br>
                    @Html.HiddenFor(temp => temp.UId, new { id = "UId" })
                            @Html.HiddenFor(temp => temp.RId, new { id = "RId" })
                            @Html.HiddenFor(temp => temp.Month, new { id = "Month" })
                            @Html.HiddenFor(temp => temp.Year, new { id = "Year" })

                    <div class="form-group">
                        <button type="submit" class="btn btn-success" onclick="return confirm('या महिन्यासाठीचा मुल्यांकन अहवाल आपण सादर करु इच्छिता?')">Submit / माहिती भरा</button>
                    </div>
                    <br>
                </div>
            </div>
        </div>
    </div>


    <br>
    <br>


}

<script src="~/Scripts/jquery-3.5.1.min.js"></script>
<script>
      $(document).ready()
    {
        var isReportSubmitted = @Html.Raw(Json.Encode(ViewBag.isReportSubmitted));
        if (isReportSubmitted == true) {
            if (window.confirm('या महिन्यासाठीचा मुल्यांकन अहवाल आपण सादर केला आहे.'))
                window.open("/Report/DepartmentWiseReport", "_self");
            else
                window.open("/Report/DepartmentWiseReport", "_self");
        }

        var Total_Marks = Number(@Session["TotalMarks"].ToString());
    }


    function Total_Reports() {
        var Total = Number($("#Last_Year_Pending").val()) + Number($("#Last_Month_Reports").val()) + Number($("#Current_Month_Reports").val());
        $("#Total_Reports").val(Total);
        $("#Total_Reports_val").val(Total);
        $("#Total_Reports_val").css("font-weight", "bold");
    }

    function Total_Action_Taken() {
        var Total = Number($("#Last_Month_Action_Taken").val()) + Number($("#Current_Month_Action_Taken").val());
        $("#Total_Action_Taken").val(Total);
        $("#Total_Action_Taken_val").val(Total);
        $("#Total_Action_Taken_val").css("font-weight", "bold");
    }



    function Action_Pending_Reports() {
        var Total = Number($("#Total_Reports").val()) - Number($("#Total_Action_Taken").val());
        $("#Action_Pending_Reports").val(Total);
        $("#Action_Pending_Reports_val").val(Total);
        $("#Action_Pending_Reports_val").css("font-weight", "bold");
    }


    function Percentage_Action_Taken() {
        var Total = (Number($("#Total_Action_Taken").val()) * 100 / Number($("#Total_Reports").val()));
        Total = Total.toFixed(2);

        if(Total >100){
            Total=100;
        }

        if (isNaN(Total) || Total == "Infinity") {  // Matches +0, -0, NaN
            Total = 0;
        }

        $("#Percentage_Action_Taken").val(Number(Total));
        $("#Percentage_Action_Taken_val").val(Number(Total));
        $("#Percentage_Action_Taken_val").css("font-weight", "bold");
    }

    function Appraisal_Marks() {

        var Appraisal_Marks = (Number($("#Total_Action_Taken").val()) * Total_Marks / Number($("#Total_Reports").val()));
        Appraisal_Marks = Appraisal_Marks.toFixed(2);

        if (Appraisal_Marks > Total_Marks) {
            Appraisal_Marks = Total_Marks
        }

        if (isNaN(Appraisal_Marks)) {  // Matches +0, -0, NaN
            Appraisal_Marks = 0;
        }

        $("#Appraisal_Marks").val(Number(Appraisal_Marks));
        $("#Appraisal_Marks_val").val(Number(Appraisal_Marks));
        $("#Appraisal_Marks_val").css("font-weight", "bold");
    }


    function SetValue() {
        $("#Percentage_Action_Taken").val(Number($("#Percentage_Action_Taken_val").val()));
        $("#Appraisal_Marks").val(Number($("#Appraisal_Marks_val").val()));
    }

    $("#Last_Year_Pending").change(Total_Reports);
    $("#Last_Month_Reports").change(Total_Reports);
    $("#Current_Month_Reports").change(Total_Reports);

    $("#Last_Month_Action_Taken").change(Total_Action_Taken);
    $("#Current_Month_Action_Taken").change(Total_Action_Taken);

    $("#Last_Year_Pending").change(Action_Pending_Reports);
    $("#Last_Month_Reports").change(Action_Pending_Reports);
    $("#Current_Month_Reports").change(Action_Pending_Reports);
    $("#Last_Month_Action_Taken").change(Action_Pending_Reports);
    $("#Current_Month_Action_Taken").change(Action_Pending_Reports);


    $("#Last_Year_Pending").change(Percentage_Action_Taken);
    $("#Last_Month_Reports").change(Percentage_Action_Taken);
    $("#Current_Month_Reports").change(Percentage_Action_Taken);
    $("#Last_Month_Action_Taken").change(Percentage_Action_Taken);
    $("#Current_Month_Action_Taken").change(Percentage_Action_Taken);

    $("#Last_Year_Pending").change(Appraisal_Marks);
    $("#Last_Month_Reports").change(Appraisal_Marks);
    $("#Current_Month_Reports").change(Appraisal_Marks);
    $("#Last_Month_Action_Taken").change(Appraisal_Marks);
    $("#Current_Month_Action_Taken").change(Appraisal_Marks);
    $("#Percentage_Action_Taken").change(Appraisal_Marks);


    $('#NotApplicable').prop('checked', false); // Unchecks Not Applicable by default

    $('#NotApplicable').click(function () {
        //If the checkbox is checked.
        if ($(this).is(':checked')) {
            //If it is checked, hide form
            $("#WrappperDiv").css("display", "none");
            

            $("Last_Year_Pending").val("0");
            $("Last_Month_Reports").val("0");
            $("Current_Month_Reports").val("0");
            $("Total_Reports").val("0");
            $("Last_Month_Action_Taken").val("0");
            $("Current_Month_Action_Taken").val("0");
            $("Total_Action_Taken").val("0");
            $("Action_Pending_Reports").val("0");
            $("Percentage_Action_Taken").val("0");
            $("Appraisal_Marks").val("0");
            $("#NotApplicable").val(true);

        } else {

            //If it is not checked, show form
            $("#WrappperDiv").css("display", "block");
        }
    });


</script>
